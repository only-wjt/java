---
title: 随笔记 
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---


车辆状态变更 回头直接找 基础的人核对嘛。
原状态值：待用(1),在用(2),已停用(3),已报废(4),已转让(5),待确认(6),已归还(7),已删除(8)
变更动作：确认(1) 停用(3),转让(4),报废(5)
  车辆刚录入保存时 1、待确认。
        1、  如果原车辆状态为 待确认。 只能选择变更为确认。（流程结束后变更为 待用。）
         
         2、如果车辆原状态为    待用。              只能选择变更为 停用。转让、报废  【已报废、已停用、已转让】

        3、车辆（已报废、已停用、已转让、已删除） 不允许发起 状态变更变更流程
		4、在用、已归还、 不能选择改为确认状态
		5、在用归还改成待用，已归还在发起车辆变更时，车辆状态变为已归还，结束后变为待用
````
function carStatusChange() {
    var rowIndexs = getGridSelectedRowIndxs();
    if (rowIndexs.length > 1) {
        $.simpleAlert("请勿多选");
    } else {
      if($[CAR_STATUS]=3||$[CAR_STATUS]=4||$[CAR_STATUS]=5){
	  		 $.simpleAlert("此车辆不能发起变更流程");
	  }
        var boId = $[_ID];
        var sid = $("#sid").val();
        awsui.ajax.request({

            url: "./jd",
            method: "POST",
            data: {
                sid: sid,
                cmd: "com.sfeg.car_carstatuschange",
               boId: boId
            },
            ok: function (ro) {
                var processInstId = ro.data.processInstId;
                var taskInstId = ro.data.taskInstId;
                //alert(processInstId+taskInstId);
                var url = "./w?sid=" + sid + "&cmd=CLIENT_BPM_FORM_MAIN_PAGE_OPEN" + "&processInstId=" + processInstId + "&taskInstId=" + taskInstId + "&openState=1";
                window.open(url, 'newInstwindow');
            },
            err: function (ro) {
	            $.simpleAlert('ro.data.msg');
            }
        });
    }
}
````


劳防用品打印，入库流程中打印事件


````
public static void appendSealList(BO sealMainData, ProcessExecutionContext ctx){
    RowMap sealBaseInfo = getBaseSealInfoByNo(sealMainData.getString("SEAL_NO"));
    String sealBaseBindId = sealBaseInfo.getString("BINDID");


    BO bo = new BO();
    bo.set("APPLY_DATE", sealMainData.get("APPLY_DATE"));
    bo.set("USER_NAME", sealMainData.get("USER_NAME"));
    bo.set("PROJECT_NO", sealMainData.get("PROJECT_NO"));
    bo.set("PROJECT_NAME", sealMainData.get("PROJECT_NAME"));
    bo.set("REASON", sealMainData.get("REASON"));
    String linkUrl = "./w?sid=@sid" + "&cmd=CLIENT_BPM_FORM_MAIN_PAGE_OPEN" + ctx.getProcessInstance().getId()
            + "&openState=2";
    bo.set("LINKURL", linkUrl);
    SDK.getBOAPI().create(Enums.SealEnum.BASE_SEAL_LIST_BONAME.getValue(), bo, sealBaseBindId, "admin");
}
````
资金计划表中的字段
项目所属组织编码
所属单位

String orgCode = mainData.getString("ORG_CODE");//这还没有确认，先放在这，其他银行支付

合同中的付款金额，还不确定是不是资金支付计划里的   orgCode先更新到资金支付计划里面，后续关注一下


暂养费费用类型对应的资金支付计划的费用类型



车辆状态为已报废、已停用、已转让、已删除，不能发起车辆变更流程
车辆状态为“待确认”的，变更动作只能为“确认”，确认后车辆状态为“待用”
车辆状态为“在用”和“已归还”的，变更动作不能选择“确认”，可以改为“报废”、“停用”、转让对应的车辆状态为“已报废、已停用、已转让”
车辆状态为“待用”的，变更动作不能选择“待用”。。。

````
根据流程节点判断某些html元素是否隐藏
<script type="text/javascript">
    var taskDefId = $("#userTaskDefId").val();
 // alert(taskDefId);
   window.onload = function(){
    if(taskDefId != 'obj_d0807b8e006543b8a952b14a9575b2f3'){
     // alert(document.getElementById('c83dbcbb_db00_0001_81d4_560011062400'));
	  document.getElementById('c83dbcbb_db00_0001_81d4_560011062400').style.display="none";
	}
		
}
</script>
````

根据流程节点隐藏某些字段或者子表
````
<script type="text/javascript">
 //alert(taskDefId);
   window.onload = function(){
      var taskDefId = $("#userTaskDefId").val();
    // alert(taskDefId);
    if(taskDefId == 'obj_7da6a2b4089a4a5489020623b7e863a0' || taskDefId == 'obj_ae7667bd7f4c4f24ae3d7deda4c9d754' || taskDefId == undefined){
		return true;
    }else{
      document.getElementById('c83dbcbb_db00_0001_81d4_560011062400').style.display="none";
     }
		
}
</script>
````

根据某个字段上面的条件，对表单上的东西进行显示隐藏
````
<script type="text/javascript">// <![CDATA[
function onComboboxChangeEvent(boItemName, $combobox, val) {
    if (boItemName == "INCOME_TYPE") {
        if (val == '1') {
            //字段隐藏显示
            $("[name='CONTRACT_NAME']").show();
            $("[name='CONTRACT_AMOUNT']").show();
            $("[name='PROJECT_NAME']").show();
            $("[name='TOTAL_AMOUNT']").show();
            //隐藏显示
            uiVisible("CONTRACT_NAME", true);
            uiVisible("CONTRACT_AMOUNT", true);
            uiVisible("PROJECT_NAME", true);
            uiVisible("TOTAL_AMOUNT", true);
        }else if(val != '1'){
            ui("CONTRACT_NAME","");
            ui("CONTRACT_AMOUNT","");
            ui("PROJECT_NAME","");
            ui("TOTAL_AMOUNT","");
            //$("#INVOICE_FLAG").change();
            //$("#INVOICE_STATUS").change();
            $("[name='CONTRACT_NAME']").hide();
            $("[name='CONTRACT_AMOUNT']").hide();
            $("[name='PROJECT_NAME']").hide();
            $("[name='TOTAL_AMOUNT']").hide();
            //隐藏显示
            uiVisible("CONTRACT_NAME", false);
            uiVisible("CONTRACT_AMOUNT", false);
            uiVisible("PROJECT_NAME", false);
            uiVisible("TOTAL_AMOUNT", false);   
        }
    }
}
// ]]></script>
````

````
  //点击事件
$("#button").click(function(){
		 var sid = $("#sid").val();
		 //var boId = $("#boId").val();
  		 var contractNo = $("#CONTRACT_NO").val(); 
 		// alert(contractNo);
  		if(contractNo == ""){
        	 $.simpleAlert("请先选择一条合同信息","info",2000);
        }else{
         awsui.ajax.request({
            url: "./jd",
            method: "POST",
            data: {
                sid: sid,
                cmd: "com.sfeg.fm.event_getprojectdetail",
				//processInstId:processInstId,
				//boId:boId,
              	code:contractNo
            },
            ok: function (ro) {
				var bindId = ro.data.bindId;
               var url = "./w?sid="+sid+"&cmd=CLIENT_DW_FORM_OPENPAGE&bindid="+bindId+"&processDefId=obj_c976ea81b42a4e0ea0d715f3bbb38e00&taskInstId=0";				
	           window.open(url, 'newInstwindow');	
            },
            err: function (ro) {
              false;
            }
        });
		
        }
})
````